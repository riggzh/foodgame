function init(e){var i=!1,c=!1;window.location.search&&("0d9753e2fe5a15db2668f70016e565ca7d717c67278ea6c689881ac4"==lcode(window.location.search)&&(i=!0),"12efa26026978758fbbbd57a70747902dba7f1a434d8dbb8cde98373"==lcode(window.location.search)&&(c=!0));var t=generateData(e,i);initRecipeTable(t,i),initChefTable(t),initKitchenwareTable(t),(i||c)&&(initCalTables(e,t),$(".nav-tabs li").removeClass("hidden")),initInfo(t),$(".loading").addClass("hidden"),$(".main-function").removeClass("hidden")}function initRecipeTable(e,i){var c,t=[{data:"recipeId"},{data:"name"},{data:{_:"fire",display:"fireDisp"}},{data:"stirfry"},{data:"boil"},{data:"cut"},{data:"fry"},{data:"roast"},{data:"steam"},{data:{_:"ingredientsVal",display:"ingredientsDisp"}},{data:"price"},{data:{_:"time",display:"timeDisp"}},{data:"total"},{data:"totalPrice"},{data:{_:"totalTime",display:"totalTimeDisp"}},{data:"efficiency"},{data:"ingredientsEff"},{data:"origin"},{data:"unlock"},{data:"guestsDisp"},{data:{_:"levelGuestsVal",display:"levelGuestsDisp"}},{data:"godRune"},{data:"quality"}];for(c in e.chefs)$("#chk-recipe-show-chef").append("<option value='"+c+"'>"+e.chefs[c].name+"</option>"),$("#recipe-table thead tr").append("<th>"+e.chefs[c].name+"</th>").append("<th>效率</th>"),t.push({data:{_:"chefs."+c+".qualityVal",display:"chefs."+c+".qualityDisp"}}),t.push({data:"chefs."+c+".efficiency"});c++,$("#recipe-table thead tr").append("<th>最佳厨师</th>").append("<th>最大效率</th>"),t.push({data:"chefs."+c+".qualityDisp"}),t.push({data:"chefs."+c+".efficiency"});var a=$("#recipe-table").DataTable({data:e.recipes,columns:t,language:{search:"查找:",lengthMenu:"一页显示 _MENU_ 个",zeroRecords:"没有找到",info:"第 _PAGE_ 页 共 _PAGES_ 页 _TOTAL_ 个菜谱",infoEmpty:"没有数据",infoFiltered:"(从 _MAX_ 个菜谱中过滤)"},pagingType:"numbers",lengthMenu:[[10,20,50,100,-1],[10,20,50,100,"所有"]],pageLength:20,dom:"<'row'<'col-sm-4'l><'col-sm-4 text-center'i><'col-sm-4'<'search-box'>>><'row'<'col-sm-12'tr>><'row'<'col-sm-12'p>>"});$("#pane-recipes div.search-box").html('<label>查找:<input type="search" class="form-control input-sm" placeholder="菜名 材料 贵客 符文"></label>'),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("recipe-table"))return!0;var t=$("#chk-recipe-fire-1").prop("checked"),a=$("#chk-recipe-fire-2").prop("checked"),l=$("#chk-recipe-fire-3").prop("checked"),s=$("#chk-recipe-fire-4").prop("checked"),n=$("#chk-recipe-fire-5").prop("checked"),r=Math.floor(i[2])||0;return!!(t&&1==r||a&&2==r||l&&3==r||s&&4==r||n&&5==r)}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){return e.nTable!=document.getElementById("recipe-table")||!!($("#chk-recipe-skill-stirfry").prop("checked")&&(Math.floor(i[3])||0)>0||$("#chk-recipe-skill-boil").prop("checked")&&(Math.floor(i[4])||0)>0||$("#chk-recipe-skill-cut").prop("checked")&&(Math.floor(i[5])||0)>0||$("#chk-recipe-skill-fry").prop("checked")&&(Math.floor(i[6])||0)>0||$("#chk-recipe-skill-roast").prop("checked")&&(Math.floor(i[7])||0)>0||$("#chk-recipe-skill-steam").prop("checked")&&(Math.floor(i[8])||0)>0)}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("recipe-table"))return!0;var t=Math.floor($("#input-recipe-price").val()),a=Math.floor(i[10])||0;return""==$("#input-recipe-price").val()||t<a}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("recipe-table"))return!0;var t=$("#chk-recipe-guest").prop("checked"),a=i[19];return!!(!t||t&&a)}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("recipe-table"))return!0;for(var t=$("#input-recipe-guest-rune").val(),a=[20,21],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("recipe-table"))return!0;for(var t=$("#pane-recipes .search-box input").val(),a=[0,1,9,19],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1}),$("#chk-recipe-show-chef").selectpicker().on("changed.bs.select",function(){initRecipeShow(a,e,i)}),$(".chk-recipe-show").click(function(){initRecipeShow(a,e,i)}),$("#chk-recipe-show-all").click(function(){$(".btn:not(.hidden) .chk-recipe-show:checked").length==$(".btn:not(.hidden) .chk-recipe-show").length?$(".btn:not(.hidden) .chk-recipe-show").prop("checked",!1):$(".btn:not(.hidden) .chk-recipe-show").prop("checked",!0),initRecipeShow(a,e,i)}),$('.chk-recipe-fire input[type="checkbox"]').click(function(){a.draw()}),$(".chk-recipe-skill").click(function(){$(this).prop("checked")&&$("#chk-recipe-single-skill").prop("checked")&&$(".chk-recipe-skill").not(this).prop("checked",!1),a.draw()}),$("#chk-recipe-single-skill").change(function(){$(this).prop("checked")&&$(".chk-recipe-skill:checked").length>1&&($(".chk-recipe-skill").prop("checked",!1),a.draw())}),$("#chk-recipe-skill-all").click(function(){$("#chk-recipe-single-skill").prop("checked")&&$("#chk-recipe-single-skill").bootstrapToggle("off"),$(".chk-recipe-skill").prop("checked",!0),a.draw()}),$("#input-recipe-price").keyup(function(){a.draw()}),$("#input-recipe-guest-rune").keyup(function(){$("#chk-recipe-show-level-guest").prop("checked")||($("#chk-recipe-show-level-guest").prop("checked",!0),initRecipeShow(a,e,i)),a.draw()}),$("#chk-recipe-guest").click(function(){a.draw()}),$("#pane-recipes .search-box input").keyup(function(){a.draw()}),i&&($("#chk-recipe-show-origin").prop("checked",!1),$("#chk-recipe-show-quality").prop("checked",!0).parent(".btn").removeClass("hidden")),initRecipeShow(a,e,i)}function initChefTable(e){var i=[{data:{_:"chefId",display:"chefIdDisp"}},{data:"name"},{data:{_:"fire",display:"fireDisp"}},{data:"stirfry"},{data:"boil"},{data:"cut"},{data:"fry"},{data:"roast"},{data:"steam"},{data:{_:"specialSkillVal",display:"specialSkillDisp"}},{data:"meat"},{data:"wheat"},{data:"veg"},{data:"fish"},{data:"sex"},{data:"origin"}];for(j in e.recipes)$("#chk-chef-show-recipe").append("<option value='"+j+"'>"+e.recipes[j].name+"</option>"),$("#chef-table thead tr").append("<th>"+e.recipes[j].name+"</th>"),i.push({data:{_:"recipes."+j+".qualityVal",display:"recipes."+j+".qualityDisp"}});var c=$("#chef-table").DataTable({data:e.chefs,columns:i,language:{search:"查找:",lengthMenu:"一页显示 _MENU_ 个",zeroRecords:"没有找到",info:"第 _PAGE_ 页 共 _PAGES_ 页 _TOTAL_ 个厨师",infoEmpty:"没有数据",infoFiltered:"(从 _MAX_ 个厨师中过滤)"},pagingType:"numbers",lengthMenu:[[10,20,50,100,-1],[10,20,50,100,"所有"]],pageLength:20,dom:"<'row'<'col-sm-4'l><'col-sm-4 text-center'i><'col-sm-4'<'search-box'>>><'row'<'col-sm-12'tr>><'row'<'col-sm-12'p>>"});$("#pane-chefs div.search-box").html('<label>查找:<input type="search" class="form-control input-sm" placeholder="名字 技能 来源"></label>'),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("chef-table"))return!0;var t=$("#chk-chef-fire-1").prop("checked"),a=$("#chk-chef-fire-2").prop("checked"),l=$("#chk-chef-fire-3").prop("checked"),s=$("#chk-chef-fire-4").prop("checked"),n=$("#chk-chef-fire-5").prop("checked"),r=Math.floor(i[2])||0;return!!(t&&1==r||a&&2==r||l&&3==r||s&&4==r||n&&5==r)}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("chef-table"))return!0;var t=Math.floor($("#input-chef-stirfry").val()),a=Math.floor(i[3])||0,l=Math.floor($("#input-chef-boil").val()),s=Math.floor(i[4])||0,n=Math.floor($("#input-chef-cut").val()),r=Math.floor(i[5])||0,o=Math.floor($("#input-chef-fry").val()),d=Math.floor(i[6])||0,h=Math.floor($("#input-chef-roast").val()),p=Math.floor(i[7])||0,u=Math.floor($("#input-chef-steam").val()),f=Math.floor(i[8])||0;return t<=a&&l<=s&&n<=r&&o<=d&&h<=p&&u<=f}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("chef-table"))return!0;var t=$("#chk-chef-sex-male").prop("checked"),a=$("#chk-chef-sex-female").prop("checked"),l=i[14];return!!(t&&"男"==l||a&&"女"==l)}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("chef-table"))return!0;for(var t=$("#pane-chefs .search-box input").val(),a=[1,9,15],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1}),$("#chk-chef-show-recipe").selectpicker().on("changed.bs.select",function(){initChefShow(c,e)}),$(".chk-chef-show").click(function(){initChefShow(c,e)}),$("#chk-chef-show-all").click(function(){$(".chk-chef-show:checked").length==$(".chk-chef-show").length?$(".chk-chef-show").prop("checked",!1):$(".chk-chef-show").prop("checked",!0),initChefShow(c,e)}),$('.chk-chef-fire input[type="checkbox"]').click(function(){c.draw()}),$(".input-chef-skill").keyup(function(){c.draw()}),$("#btn-chef-skill-clear").click(function(){$(".input-chef-skill").val(""),c.draw()}),$('.chk-chef-sex input[type="checkbox"]').click(function(){c.draw()}),$("#pane-chefs .search-box input").keyup(function(){c.draw()}),initChefShow(c,e)}function initKitchenwareTable(e){var i=[{data:"kitchenwareId"},{data:"name"},{data:{_:"fire",display:"fireDisp"}},{data:{_:"skillVal",display:"skillDisp"}},{data:"origin"}],c=$("#kitchenware-table").DataTable({data:e.kitchenware,columns:i,language:{search:"查找:",lengthMenu:"一页显示 _MENU_ 个",zeroRecords:"没有找到",info:"第 _PAGE_ 页 共 _PAGES_ 页 _TOTAL_ 个厨具",infoEmpty:"没有数据",infoFiltered:"(从 _MAX_ 个厨具中过滤)"},pagingType:"numbers",lengthMenu:[[10,20,50,100,-1],[10,20,50,100,"所有"]],pageLength:20,dom:"<'row'<'col-sm-4'l><'col-sm-4 text-center'i><'col-sm-4'<'search-box'>>><'row'<'col-sm-12'tr>><'row'<'col-sm-12'p>>"});$("#pane-kitchenware div.search-box").html('<label>查找:<input type="search" class="form-control input-sm" placeholder="名字 技能 来源"></label>'),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("kitchenware-table"))return!0;var t=i[3];return!!($("#chk-kitchenware-skill-stirfry-price").prop("checked")&&t.indexOf("炒类料理")>=0||$("#chk-kitchenware-skill-boil-price").prop("checked")&&t.indexOf("煮类料理")>=0||$("#chk-kitchenware-skill-cut-price").prop("checked")&&t.indexOf("切类料理")>=0||$("#chk-kitchenware-skill-fry-price").prop("checked")&&t.indexOf("炸类料理")>=0||$("#chk-kitchenware-skill-roast-price").prop("checked")&&t.indexOf("烤类料理")>=0||$("#chk-kitchenware-skill-steam-price").prop("checked")&&t.indexOf("蒸类料理")>=0||$("#chk-kitchenware-skill-meet-price").prop("checked")&&t.indexOf("肉类料理")>=0||$("#chk-kitchenware-skill-wheat-price").prop("checked")&&t.indexOf("面类料理")>=0||$("#chk-kitchenware-skill-veg-price").prop("checked")&&t.indexOf("蔬菜料理")>=0||$("#chk-kitchenware-skill-fish-price").prop("checked")&&t.indexOf("水产料理")>=0||$("#chk-kitchenware-skill-sell-price").prop("checked")&&t.indexOf("金币获得")>=0||$("#chk-kitchenware-skill-stirfry-skill").prop("checked")&&t.indexOf("炒技法")>=0||$("#chk-kitchenware-skill-boil-skill").prop("checked")&&t.indexOf("煮技法")>=0||$("#chk-kitchenware-skill-cut-skill").prop("checked")&&t.indexOf("切技法")>=0||$("#chk-kitchenware-skill-fry-skill").prop("checked")&&t.indexOf("炸技法")>=0||$("#chk-kitchenware-skill-roast-skill").prop("checked")&&t.indexOf("烤技法")>=0||$("#chk-kitchenware-skill-steam-skill").prop("checked")&&t.indexOf("蒸技法")>=0||$("#chk-kitchenware-skill-all-skill").prop("checked")&&t.indexOf("全技法")>=0||$("#chk-kitchenware-skill-guest").prop("checked")&&t.indexOf("稀有客人")>=0||$("#chk-kitchenware-skill-time").prop("checked")&&t.indexOf("开业时间")>=0||$("#chk-kitchenware-skill-ingredient-get").prop("checked")&&t.indexOf("素材获得")>=0||$("#chk-kitchenware-skill-meet-skill").prop("checked")&&t.indexOf("肉类采集")>=0||$("#chk-kitchenware-skill-wheat-skill").prop("checked")&&t.indexOf("面类采集")>=0||$("#chk-kitchenware-skill-veg-skill").prop("checked")&&t.indexOf("蔬菜采集")>=0||$("#chk-kitchenware-skill-fish-skill").prop("checked")&&t.indexOf("水产采集")>=0||$("#chk-kitchenware-skill-ingredient-skill").prop("checked")&&t.indexOf("全采集")>=0)}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("kitchenware-table"))return!0;for(var t=$("#pane-kitchenware .search-box input").val(),a=[1,3,4],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1}),$(".chk-kitchenware-show").click(function(){initKitchenwareShow(c)}),$("#chk-kitchenware-show-all").click(function(){$(".chk-kitchenware-show:checked").length==$(".chk-kitchenware-show").length?$(".chk-kitchenware-show").prop("checked",!1):$(".chk-kitchenware-show").prop("checked",!0),initKitchenwareShow(c)}),$(".chk-kitchenware-skill").click(function(){$(this).prop("checked")&&$("#chk-kitchenware-single-skill").prop("checked")&&$(".chk-kitchenware-skill").not(this).prop("checked",!1),c.draw()}),$("#chk-kitchenware-single-skill").change(function(){$(this).prop("checked")&&$(".chk-kitchenware-skill:checked").length>1&&($(".chk-kitchenware-skill").prop("checked",!1),c.draw())}),$("#chk-kitchenware-skill-all").click(function(){$("#chk-kitchenware-single-skill").prop("checked")&&$("#chk-kitchenware-single-skill").bootstrapToggle("off"),$(".chk-kitchenware-skill").prop("checked",!0),c.draw()}),$("#pane-kitchenware .search-box input").keyup(function(){c.draw()}),initKitchenwareShow(c)}function initCalTables(e,i){initCalRecipesTable(i),initCalChefsTable(i),initCalIngredientsTable(i),initCalResultsTable(i),initCalSelfSelect(i),$.fn.dataTable.ext.order["dom-selected"]=function(e,i){return this.api().column(i,{order:"index"}).nodes().map(function(e,i){return $(e).parent("tr").hasClass("selected")?"1":"0"})},$("#pane-cal-results-common").remove()}function initCalRecipesTable(e){var i=generateCalRecipeData(e.recipes),c=[{data:void 0,defaultContent:"",className:"select-checkbox",orderDataType:"dom-selected",width:"30px"},{data:"recipeId"},{data:"name"},{data:{_:"fire",display:"fireDisp"}},{data:"stirfry"},{data:"boil"},{data:"cut"},{data:"fry"},{data:"roast"},{data:"steam"},{data:{_:"ingredientsVal",display:"ingredientsDisp"}},{data:"price"},{data:"total"},{data:"totalPrice"},{data:"origin"},{data:"addition",className:"cal-td-input-addition",width:"38px"}],t=$("#cal-recipes-table").DataTable({data:i,columns:c,language:{search:"查找:",lengthMenu:"一页显示 _MENU_ 个",zeroRecords:"没有找到",info:"共 _MAX_ 个菜谱",infoEmpty:"没有数据",infoFiltered:"",select:{rows:{_:"选择了 %d 个菜谱",0:"选择了 %d 个菜谱",1:"选择了 %d 个菜谱"}}},pagingType:"numbers",lengthMenu:[[10,20,50,100,-1],[10,20,50,100,"所有"]],pageLength:20,dom:"<'row'<'col-sm-4'l><'col-sm-4 text-center'i><'col-sm-4'<'search-box'>>><'row'<'col-sm-12'tr>><'row'<'col-sm-12'p>>",select:{style:"multi",selector:"td.select-checkbox"},autoWidth:!1,createdRow:function(e,i,c){$(e).addClass("fire-"+i.fire)}});$("#pane-cal-recipes div.search-box").html('<label>查找:<input type="search" class="form-control input-sm" placeholder="菜名 材料"></label>'),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("cal-recipes-table"))return!0;for(var t=$("#pane-cal-recipes .search-box input").val(),a=[2,10],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1}),t.MakeCellsEditable({columns:[15]}),$(".chk-cal-recipes-show").click(function(){initCalRecipesShow(t)}),$(".chk-cal-recipes-fire").click(function(){$("#chk-cal-recipes-fire-1").prop("checked")?t.rows(".fire-1").select():t.rows(".fire-1").deselect(),$("#chk-cal-recipes-fire-2").prop("checked")?t.rows(".fire-2").select():t.rows(".fire-2").deselect(),$("#chk-cal-recipes-fire-3").prop("checked")?t.rows(".fire-3").select():t.rows(".fire-3").deselect(),$("#chk-cal-recipes-fire-4").prop("checked")?t.rows(".fire-4").select():t.rows(".fire-4").deselect(),$("#chk-cal-recipes-fire-5").prop("checked")?t.rows(".fire-5").select():t.rows(".fire-5").deselect()}),$("#chk-cal-recipes-addition").change(function(){initCalRecipesShow(t),$(this).prop("checked")?$("#chk-cal-recipes-addition-wrapper").removeClass("hidden"):$("#chk-cal-recipes-addition-wrapper").addClass("hidden")}),$("#btn-cal-recipes-addition-clear").click(function(){t.rows().every(function(e,i,c){this.cell(e,".cal-td-input-addition").data("")})}),$("#btn-cal-recipes-addition-add").click(function(){var e=$("#select-cal-recipes-category").val(),i=Math.floor($("#input-cal-recipes-addition").val())||"";e&&t.rows().every(function(c,t,a){var l=this.data().categories;for(var s in l)l[s]==e&&this.cell(c,".cal-td-input-addition").data(i)})}),$("#pane-cal-recipes .search-box input").keyup(function(){t.draw()}),$("#btn-cal-recipes-select-all").click(function(){$('.chk-cal-recipes-fire input[type="checkbox"]').prop("checked",!0),t.rows().select()}),$("#btn-cal-recipes-deselect-all").click(function(){$('.chk-cal-recipes-fire input[type="checkbox"]').prop("checked",!1),t.rows().deselect()}),t.rows().select(),initCalRecipesShow(t)}function initCalChefsTable(e){var i=[{data:void 0,defaultContent:"",className:"select-checkbox",orderDataType:"dom-selected",width:"30px"},{data:{_:"chefId",display:"chefIdDisp"}},{data:"name"},{data:{_:"fire",display:"fireDisp"}},{data:"stirfry"},{data:"boil"},{data:"cut"},{data:"fry"},{data:"roast"},{data:"steam"},{data:{_:"specialSkillVal",display:"specialSkillDisp"}},{data:"sex"},{data:"origin"},{data:"addition",className:"cal-td-input-addition",width:"38px"},{data:"kitchenwareName",className:"cal-td-select-kitchenware",width:"222px"}],c=$("#cal-chefs-table").DataTable({data:e.chefs,columns:i,language:{search:"查找:",lengthMenu:"一页显示 _MENU_ 个",zeroRecords:"没有找到",info:"共 _MAX_ 个厨师",infoEmpty:"没有数据",infoFiltered:"",select:{rows:{_:"选择了 %d 个厨师",0:"选择了 %d 个厨师",1:"选择了 %d 个厨师"}}},pagingType:"numbers",lengthMenu:[[10,20,50,100,-1],[10,20,50,100,"所有"]],pageLength:20,dom:"<'row'<'col-sm-4'l><'col-sm-4 text-center'i><'col-sm-4'<'search-box'>>><'row'<'col-sm-12'tr>><'row'<'col-sm-12'p>>",select:{style:"multi",selector:"td.select-checkbox"},autoWidth:!1,createdRow:function(e,i,c){$(e).addClass("fire-"+i.fire),$(e).addClass("男"==i.sex?"sex-1":"sex-0")}});$("#pane-cal-chefs div.search-box").html('<label>查找:<input type="search" class="form-control input-sm" placeholder="名字 性别"></label>'),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("cal-chefs-table"))return!0;for(var t=$("#pane-cal-chefs .search-box input").val(),a=[2,11],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1});var t=getKitchenwareOptions(e.kitchenware);c.MakeCellsEditable({columns:[13,14],inputTypes:[{column:14,type:"list",options:t}]}),$(".chk-cal-chefs-show").click(function(){initCalChefsShow(c)}),$('.chk-cal-chefs-fire input[type="checkbox"], .chk-cal-chefs-sex input[type="checkbox"]').click(function(){var e=$("#chk-cal-chefs-fire-1").prop("checked"),i=$("#chk-cal-chefs-fire-2").prop("checked"),t=$("#chk-cal-chefs-fire-3").prop("checked"),a=$("#chk-cal-chefs-fire-4").prop("checked"),l=$("#chk-cal-chefs-fire-5").prop("checked"),s=$("#chk-cal-chefs-sex-male").prop("checked"),n=$("#chk-cal-chefs-sex-female").prop("checked");e&&s?c.rows(".sex-1.fire-1").select():c.rows(".sex-1.fire-1").deselect(),e&&n?c.rows(".sex-0.fire-1").select():c.rows(".sex-0.fire-1").deselect(),i&&s?c.rows(".sex-1.fire-2").select():c.rows(".sex-1.fire-2").deselect(),i&&n?c.rows(".sex-0.fire-2").select():c.rows(".sex-0.fire-2").deselect(),t&&s?c.rows(".sex-1.fire-3").select():c.rows(".sex-1.fire-3").deselect(),t&&n?c.rows(".sex-0.fire-3").select():c.rows(".sex-0.fire-3").deselect(),a&&s?c.rows(".sex-1.fire-4").select():c.rows(".sex-1.fire-4").deselect(),a&&n?c.rows(".sex-0.fire-4").select():c.rows(".sex-0.fire-4").deselect(),l&&s?c.rows(".sex-1.fire-5").select():c.rows(".sex-1.fire-5").deselect(),l&&n?c.rows(".sex-0.fire-5").select():c.rows(".sex-0.fire-5").deselect()}),$("#chk-cal-chefs-addition").change(function(){initCalChefsShow(c),$(this).prop("checked")?$("#chk-cal-chefs-addition-wrapper").removeClass("hidden"):$("#chk-cal-chefs-addition-wrapper").addClass("hidden")}),$("#btn-cal-chefs-addition-clear").click(function(){c.rows().every(function(e,i,c){this.cell(e,".cal-td-input-addition").data("")})}),$("#btn-cal-chefs-addition-add").click(function(){var e=$("#select-cal-chefs-sex").val(),i=Math.floor($("#input-cal-chefs-addition").val())||"";e&&c.rows().every(function(c,t,a){this.data().sex==e&&this.cell(c,".cal-td-input-addition").data(i)})}),$("#chk-cal-chefs-kitchenware").change(function(){initCalChefsShow(c),$(this).prop("checked")?$("#btn-cal-chefs-kitchenware-clear").removeClass("hidden"):$("#btn-cal-chefs-kitchenware-clear").addClass("hidden")}),$("#btn-cal-chefs-kitchenware-clear").click(function(){c.rows().every(function(e,i,c){this.cell(e,".cal-td-select-kitchenware").data("")})}),$("#pane-cal-chefs .search-box input").keyup(function(){c.draw()}),$("#btn-cal-chefs-select-all").click(function(){$('.chk-cal-chefs-fire input[type="checkbox"]').prop("checked",!0),$('.chk-cal-chefs-sex input[type="checkbox"]').prop("checked",!0),c.rows().select()}),$("#btn-cal-chefs-deselect-all").click(function(){$('.chk-cal-chefs-fire input[type="checkbox"]').prop("checked",!1),$('.chk-cal-chefs-sex input[type="checkbox"]').prop("checked",!1),c.rows().deselect()}),c.rows().select(),initCalChefsShow(c)}function initCalIngredientsTable(e){var i=[{data:void 0,defaultContent:"",className:"select-checkbox",orderDataType:"dom-selected",width:"30px"},{data:"ingredientId"},{data:"name"},{data:{_:"fire",display:"fireDisp"}},{data:"origin"},{data:"addition",className:"cal-td-input-addition",width:"38px"}],c=$("#cal-ingredients-table").DataTable({data:e.ingredients,columns:i,language:{search:"查找:",lengthMenu:"一页显示 _MENU_ 个",zeroRecords:"没有找到",info:"共 _MAX_ 个食材",infoEmpty:"没有数据",infoFiltered:"",select:{rows:{_:"选择了 %d 个食材",0:"选择了 %d 个食材",1:"选择了 %d 个食材"}}},pagingType:"numbers",lengthMenu:[[10,20,50,100,-1],[10,20,50,100,"所有"]],pageLength:20,dom:"<'row'<'col-sm-4'l><'col-sm-4 text-center'i><'col-sm-4'<'search-box'>>><'row'<'col-sm-12'tr>><'row'<'col-sm-12'p>>",select:{style:"multi",selector:"td.select-checkbox"},autoWidth:!1,createdRow:function(e,i,c){$(e).addClass("origin-"+i.originVal)}});$("#pane-cal-ingredients div.search-box").html('<label>查找:<input type="search" class="form-control input-sm" placeholder="名字 来源"></label>'),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("cal-ingredients-table"))return!0;for(var t=$("#pane-cal-ingredients .search-box input").val(),a=[2,4],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1}),c.MakeCellsEditable({columns:[5]}),$(".chk-cal-ingredients-show").click(function(){initCalIngredientsShow(c)}),$('.chk-cal-ingredients-origin input[type="checkbox"]').click(function(){$("#chk-cal-ingredients-origin-greenhouse").prop("checked")?c.rows(".origin-1").select():c.rows(".origin-1").deselect(),$("#chk-cal-ingredients-origin-garden").prop("checked")?c.rows(".origin-2").select():c.rows(".origin-2").deselect(),$("#chk-cal-ingredients-origin-forest").prop("checked")?c.rows(".origin-3").select():c.rows(".origin-3").deselect(),$("#chk-cal-ingredients-origin-chicken").prop("checked")?c.rows(".origin-4").select():c.rows(".origin-4").deselect(),$("#chk-cal-ingredients-origin-pork").prop("checked")?c.rows(".origin-5").select():c.rows(".origin-5").deselect(),$("#chk-cal-ingredients-origin-beef").prop("checked")?c.rows(".origin-6").select():c.rows(".origin-6").deselect(),$("#chk-cal-ingredients-origin-wheat").prop("checked")?c.rows(".origin-7").select():c.rows(".origin-7").deselect(),$("#chk-cal-ingredients-origin-fish").prop("checked")?c.rows(".origin-8").select():c.rows(".origin-8").deselect()}),$("#chk-cal-ingredients-addition").change(function(){initCalIngredientsShow(c),$(this).prop("checked")?$("#chk-cal-ingredients-addition-wrapper").removeClass("hidden"):$("#chk-cal-ingredients-addition-wrapper").addClass("hidden")}),$("#btn-cal-ingredients-addition-clear").click(function(){c.rows().every(function(e,i,c){this.cell(e,".cal-td-input-addition").data("")})}),$("#btn-cal-ingredients-addition-add").click(function(){var e=$("#select-cal-ingredients-origin").val(),i=Math.floor($("#input-cal-ingredients-addition").val())||"";e&&c.rows().every(function(c,t,a){this.data().origin==e&&this.cell(c,".cal-td-input-addition").data(i)})}),$("#pane-cal-ingredients .search-box input").keyup(function(){c.draw()}),$("#btn-cal-ingredients-select-all").click(function(){$('.chk-cal-ingredients-origin input[type="checkbox"]').prop("checked",!0),c.rows().select()}),$("#btn-cal-ingredients-deselect-all").click(function(){$('.chk-cal-ingredients-origin input[type="checkbox"]').prop("checked",!1),c.rows().deselect()}),c.rows().select(),initCalIngredientsShow(c)}function initCalResultsTable(e){$("#cal-recipes-results-place").html($("#pane-cal-results-common").html()),$("#cal-recipes-results-place .cal-results-table").prop("id","cal-recipes-results-table"),$("#cal-recipes-results-place .chk-cal-results-show-selected").bootstrapToggle(),$("#cal-all-results-place").html($("#pane-cal-results-common").html()),$("#cal-all-results-place .cal-results-table").prop("id","cal-all-results-table"),$("#cal-all-results-place .chk-cal-results-show-selected").bootstrapToggle(),$("#cal-optimal-results-place").html($("#pane-cal-results-common").html()),$("#cal-optimal-results-place .cal-results-table").prop("id","cal-optimal-results-table"),$("#cal-optimal-results-place .chk-cal-results-show-selected").remove(),initCalResultTableCommon("all",new Array,$("#pane-cal-all-results")),initCalResultTableCommon("optimal",new Array,$("#pane-cal-optimal-results")),initCalResultTableCommon("recipes",new Array,$("#pane-cal-recipes-results"));var i,c,t;$(".btn-cal-results-cal").click(function(){var a,l,s=$(this).closest(".pane-cal-results");if("pane-cal-all-results"==s.prop("id"))l="all",a=c;else if("pane-cal-optimal-results"==s.prop("id"))l="optimal",a=t;else{if("pane-cal-recipes-results"!=s.prop("id"))return;l="recipes",a=i}if(void 0!==a&&(a.terminate(),a=void 0),$(this).hasClass("stop"))return s.find(".cal-results-progress").addClass("hidden"),s.find(".btn-cal-results-cal.start").prop("disabled",!1),void s.find(".btn-cal-results-cal.stop").prop("disabled",!0);s.find(".btn-cal-results-cal.start").prop("disabled",!0),s.find(".btn-cal-results-cal.stop").prop("disabled",!1),s.find(".cal-results-wrapper").addClass("hidden"),s.find(".cal-results-progress .progress-bar").css("width","0%"),s.find(".cal-results-progress .progress-bar span").text("预处理中"),s.find(".cal-results-progress").removeClass("hidden"),a=new Worker("js/cal.js?v=2"),"all"==l?c=a:"optimal"==l?t=a:"recipes"==l&&(i=a),a.onmessage=function(e){e.data.progress?(s.find(".cal-results-progress .progress-bar").css("width",e.data.progress.value+"%"),s.find(".cal-results-progress .progress-bar span").text(e.data.progress.display)):e.data.menu&&(s.find(".btn-cal-results-cal.stop").prop("disabled",!0),setTimeout(function(){s.find(".cal-results-progress .progress-bar span").text("加载中")},500),setTimeout(function(){e.data.message?s.find(".selected-sum").html(e.data.message):s.find(".selected-sum").html("点击可选择"),"all"==l?(s.find(".chk-cal-results-show-selected").prop("checked",!1),$("#cal-all-results-table").DataTable().clear().rows.add(e.data.menu).draw(!1)):"optimal"==l?($("#cal-optimal-results-table").DataTable().clear().rows.add(e.data.menu).draw(!1),$("#cal-optimal-results-table").DataTable().rows().select()):"recipes"==l&&(s.find(".chk-cal-results-show-selected").prop("checked",!1),$("#cal-recipes-results-table").DataTable().clear().rows.add(e.data.menu).draw(!1)),s.find(".cal-results-wrapper").removeClass("hidden"),s.find(".cal-results-progress").addClass("hidden"),s.find(".btn-cal-results-cal.start").prop("disabled",!1),s.find(".btn-cal-results-cal.stop").prop("disabled",!0)},1e3))};var n=$("#cal-recipes-table").DataTable().rows({selected:!0}).data().toArray(),r=$("#cal-chefs-table").DataTable().rows({selected:!0}).data().toArray(),o=$("#cal-ingredients-table").DataTable().rows({selected:!0}).data().toArray(),d=Math.floor($("#input-cal-all-results-show-top").val()),h=$("#select-cal-optimal-results-chefs-number").val(),p=$("#select-cal-optimal-results-recipes-number").val(),u=$("#chk-cal-recipes-mulitple").prop("checked"),f=$("#chk-cal-recipes-addition").prop("checked"),k=$("#chk-cal-chefs-addition").prop("checked"),m=$("#chk-cal-chefs-kitchenware").prop("checked"),w=$("#chk-cal-ingredients-addition").prop("checked"),b=$("#chk-cal-ingredients-addition-cumulative").prop("checked");a.postMessage({mode:l,recipes:n,chefs:r,ingredients:o,kitchenware:e.kitchenware,allLimit:d,optimalChefsNum:h,optimalRecipesNum:p,recipesMulitple:u,hasRecipesAddition:f,hasChefsAddition:k,hasKitchenware:m,hasIngredientsAddition:w,ingredientsAdditionCumulative:b})})}function initCalResultTableCommon(e,i,c){var t=[{data:void 0,defaultContent:"",className:"select-checkbox",orderDataType:"dom-selected",width:"30px"},{data:"chef.name",className:"cal-td-chef-name",defaultContent:""},{data:{_:"chef.fire",display:"chef.fireDisp"},defaultContent:""},{data:"chef.sex",defaultContent:""},{data:"chef.stirfry",defaultContent:""},{data:"chef.boil",defaultContent:""},{data:"chef.cut",defaultContent:""},{data:"chef.fry",defaultContent:""},{data:"chef.roast",defaultContent:""},{data:"chef.steam",defaultContent:""},{data:"recipe.data.name",className:"cal-td-recipe-name",defaultContent:""},{data:{_:"recipe.data.fire",display:"recipe.data.fireDisp"},defaultContent:""},{data:"recipe.data.stirfry",defaultContent:""},{data:"recipe.data.boil",defaultContent:""},{data:"recipe.data.cut",defaultContent:""},{data:"recipe.data.fry",defaultContent:""},{data:"recipe.data.roast",defaultContent:""},{data:"recipe.data.steam",defaultContent:""},{data:{_:"recipe.data.ingredientsVal",display:"recipe.data.ingredientsDisp"},defaultContent:""},{data:"recipe.data.price",defaultContent:""},{data:"recipe.quantity",className:"cal-td-quantity",defaultContent:"",width:"38px"},{data:{_:"recipe.qualityVal",display:"recipe.qualityDisp"},defaultContent:""},{data:{_:"recipe.qualityAddition",display:"recipe.qualityAdditionDisp"},defaultContent:""},{data:{_:"recipe.skillAddition",display:"recipe.skillAdditionDisp"},defaultContent:""},{data:"kitchenware.disp",className:"cal-td-kitchenware-name",defaultContent:""},{data:{_:"recipe.kitchenwareAddition",display:"recipe.kitchenwareAdditionDisp"},defaultContent:""},{data:{_:"recipe.otherAddition",display:"recipe.otherAdditionDisp"},defaultContent:""},{data:"recipe.totalPrice",defaultContent:""},{data:"recipe.realTotalPrice",defaultContent:""},{data:"recipe.bonusScore",defaultContent:""},{data:"recipe.totalScore",defaultContent:""}],a=!0;"optimal"!=e&&"self-select"!=e||(a=!1);var l=c.find(".cal-results-table").DataTable({data:i,columns:t,language:{search:"查找:",lengthMenu:"一页显示 _MENU_ 条",zeroRecords:"没有找到",info:"共 _TOTAL_ 条",infoEmpty:"没有数据",infoFiltered:"(从 _MAX_ 条中过滤)",select:{rows:{_:"选择了 %d 条",0:"选择了 %d 条",1:"选择了 %d 条"}}},paging:a,pagingType:"numbers",lengthMenu:[[10,20,50,100,-1],[10,20,50,100,"所有"]],pageLength:20,dom:"<'row'<'col-sm-12'<'selected-sum'>>><'row'<'col-sm-4'l><'col-sm-4 text-center'i><'col-sm-4'<'search-box'>>><'row'<'col-sm-12'tr>><'row'<'col-sm-12'p>>",select:{style:"multi",selector:"td.select-checkbox"},autoWidth:!1,order:[[30,"desc"]]});if(c.find(".selected-sum").html("点击可选择"),"all"==e||"recipes"==e){c.find("div.search-box").html('<label>查找:<input type="search" class="form-control input-sm" placeholder="厨师 菜名 材料"></label>'),c.find(".search-box input").keyup(function(){l.draw()}),c.find(".chk-cal-results-show-selected").prop("checked",!1);var s="",n="";c.find(".chk-cal-results-show-selected").change(function(){$(this).prop("checked")?(s=c.find(".search-box input").val(),c.find(".search-box input").val(n)):(n=c.find(".search-box input").val(),c.find(".search-box input").val(s)),l.draw()})}return l.on("select deselect",function(i,t,a,s){if("row"===a){var n=t.rows({selected:!0}).indexes(),r=t.cells(n,27).data().reduce(function(e,i){return e+i},0),o="原售价："+r;if("all"==e||"optimal"==e||"self-select"==e){o+=" 实售价："+t.cells(n,28).data().reduce(function(e,i){return e+i},0)}o+=" 规则分："+t.cells(n,29).data().reduce(function(e,i){return e+i},0);o+=" 总得分："+t.cells(n,30).data().reduce(function(e,i){return e+i},0),
    c.find(".selected-sum").html(o),"all"!=e&&"recipes"!=e||c.find(".chk-cal-results-show-selected").prop("checked")&&l.draw()}}),c.find(".chk-cal-results-show").click(function(){initCalResultsShow(e,l,c)}),c.find(".chk-cal-results-show-all").click(function(){c.find(".btn:not(.hidden) .chk-cal-results-show:checked").length==c.find(".btn:not(.hidden) .chk-cal-results-show").length?c.find(".btn:not(.hidden) .chk-cal-results-show").prop("checked",!1):c.find(".btn:not(.hidden) .chk-cal-results-show").prop("checked",!0),initCalResultsShow(e,l,c)}),"all"==e?($.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("cal-all-results-table"))return!0;for(var t=$("#pane-cal-all-results .search-box input").val(),a=[1,10,18],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("cal-all-results-table"))return!0;if($("#pane-cal-all-results .chk-cal-results-show-selected").prop("checked")){var t=e.aoData[c].nTr;return!!$(t).hasClass("selected")}return!0})):"recipes"==e&&($.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("cal-recipes-results-table"))return!0;for(var t=$("#pane-cal-recipes-results .search-box input").val(),a=[1,10,18],l=0,s=a.length;l<s;l++)if(-1!==i[a[l]].indexOf(t))return!0;return!1}),$.fn.dataTableExt.afnFiltering.push(function(e,i,c){if(e.nTable!=document.getElementById("cal-recipes-results-table"))return!0;if($("#pane-cal-recipes-results .chk-cal-results-show-selected").prop("checked")){var t=e.aoData[c].nTr;return!!$(t).hasClass("selected")}return!0})),initCalResultsShow(e,l,c),l}function initCalSelfSelect(e){$("#cal-self-select-place").html($("#pane-cal-results-common").html()),$("#cal-self-select-place .cal-results-table").prop("id","cal-self-select-table"),$("#cal-self-select-place .chk-cal-results-show-selected").remove(),$("#cal-self-select-place .chk-cal-results-show-chef-kitchenware").prop("checked",!0);for(var i=new Array,c=0;c<9;c++){var t=new Object;t.chef=new Object,t.recipe=new Object,t.kitchenware=new Object,i.push(t)}var a=initCalResultTableCommon("self-select",i,$("#pane-cal-self-select"));$("#pane-cal-self-select").find(".cal-results-wrapper").removeClass("hidden");var l=$("#cal-chefs-table").DataTable().data().toArray(),s=$("#cal-recipes-table").DataTable().data().toArray(),n=getChefsOptions(l),r=getRecipesOptions(s),o=getKitchenwareOptions(e.kitchenware);a.MakeCellsEditable({columns:[1,10,20,24],inputTypes:[{column:1,type:"list",options:n},{column:10,type:"list",options:r},{column:24,type:"list",options:o}],onUpdate:function(i,c,t){for(var a=$("#cal-recipes-table").DataTable().rows({selected:!0}).data().toArray(),l=$("#cal-chefs-table").DataTable().rows({selected:!0}).data().toArray(),s=($("#cal-ingredients-table").DataTable().rows({selected:!0}).data().toArray(),$("#chk-cal-chefs-addition").prop("checked")),n=$("#chk-cal-recipes-addition").prop("checked"),r=$("#chk-cal-ingredients-addition").prop("checked"),o=$("#chk-cal-ingredients-addition-cumulative").prop("checked"),d=i.data().toArray(),h=0;h<d.length;h++){var p=new Object;if(d[h].chef.name)for(var u in l)d[h].chef.name==l[u].name&&(p=$.extend(!0,{},l[u]));d[h].chef=p;var f=new Object;if(f.quantity=d[h].recipe.quantity,d[h].recipe.data&&d[h].recipe.data.name)for(var u in a)d[h].recipe.data.name==a[u].name&&(f.data=$.extend(!0,{},a[u]));if(d[h].recipe=f,d[h].chef.name&&d[h].recipe.data&&d[h].recipe.quantity){var k,m=!1;d[h].kitchenware&&d[h].kitchenware.disp&&(m=!0,k=getKitchenwareInfo(d[h].kitchenware.disp,e.kitchenware));var w=getRecipeResult(d[h].chef,s,m,k,d[h].recipe.data,d[h].recipe.quantity,n,e.ingredients,r,o);w&&(d[h].recipe=w)}}i.clear().rows.add(d).draw(!1)}})}function generateData(e,c){var t=new Object;t.history=e.history;var a=new Array;for(i in e.ingredients){var l=new Object;l=e.ingredients[i],l.fireDisp=getFireDisp(e.ingredients[i].fire),l.originVal=getOriginVal(e.ingredients[i].origin),l.addition="",a.push(l)}t.ingredients=a;var s=new Array;for(i in e.kitchenware)if(e.kitchenware[i].name){var r=new Object;r=e.kitchenware[i],r.fireDisp=getFireDisp(e.kitchenware[i].fire);var o=getSkillInfo(e.kitchenware[i].skill);r.skillVal=o.skillVal,r.skillDisp=o.skillDisp,s.push(r)}t.kitchenware=s;var d=new Array;for(i in e.chefs)if(e.chefs[i].name){var h=new Object;h=e.chefs[i],h.recipes=new Array,h.stirfry=e.chefs[i].stirfry||"",h.boil=e.chefs[i].boil||"",h.cut=e.chefs[i].cut||"",h.fry=e.chefs[i].fry||"",h.roast=e.chefs[i].roast||"",h.steam=e.chefs[i].steam||"",h.meat=e.chefs[i].meat||"",h.wheat=e.chefs[i].wheat||"",h.veg=e.chefs[i].veg||"",h.fish=e.chefs[i].fish||"",h.addition="",h.kitchenwareName="",h.chefIdDisp=e.chefs[i].chefId+" - "+(e.chefs[i].chefId+2),h.fireDisp=getFireDisp(e.chefs[i].fire);var o=getSkillInfo(e.chefs[i].skill);h.specialSkillVal=o.skillVal,h.specialSkillDisp=o.skillDisp,d.push(h)}t.chefs=d;var p=new Array;for(i in e.recipes)if(e.recipes[i].name){var u=new Object;u=e.recipes[i],u.stirfry=e.recipes[i].stirfry||"",u.boil=e.recipes[i].boil||"",u.cut=e.recipes[i].cut||"",u.fry=e.recipes[i].fry||"",u.roast=e.recipes[i].roast||"",u.steam=e.recipes[i].steam||"",u.price=e.recipes[i].price||"",u.total=e.recipes[i].total||"",u.addition="",u.timeDisp=secondsToTime(e.recipes[i].time),u.fireDisp=getFireDisp(e.recipes[i].fire);var f=0,k=0,w=0;e.recipes[i].price>0&&e.recipes[i].time>0&&(w=3600*e.recipes[i].price/e.recipes[i].time,e.recipes[i].total>0&&(f=e.recipes[i].price*e.recipes[i].total,k=e.recipes[i].time*e.recipes[i].total)),u.totalPrice=f||"",u.totalTime=k,u.totalTimeDisp=secondsToTime(k),u.efficiency=w?Math.floor(w):"";var b=getIngredientsInfo(e.recipes[i]);u.ingredientsVal=b.ingredientsVal,u.ingredientsDisp=b.ingredientsDisp;var $=0;e.recipes[i].time>0&&($=3600*b.ingredientsCount/e.recipes[i].time),u.ingredientsEff=$?Math.floor($):"";var v="",y="";for(g in e.recipes[i].guests)if(e.recipes[i].guests[g].guest){if(c&&("优"==e.recipes[i].quality&&"优"==e.recipes[i].guests[g].quality||"特"==e.recipes[i].quality&&"神"!=e.recipes[i].guests[g].quality||"神"==e.recipes[i].quality))continue;v+=e.recipes[i].guests[g].quality+"-"+e.recipes[i].guests[g].guest+"<br>",y+=e.recipes[i].guests[g].guest}u.levelGuestsVal=y,u.levelGuestsDisp=v;var x="";for(m in e.guests)for(n in e.guests[m].gifts)if(e.recipes[i].name==e.guests[m].gifts[n].recipe){x+=e.guests[m].name+"-"+e.guests[m].gifts[n].rune+"<br>";break}u.guestsDisp=x,u.chefs=new Array;var C=0,T="";for(j in t.chefs){var D=getQualityInfo(e.recipes[i],t.chefs[j],!1,null),_=0;if(D.qualityVal>0){var O=getSkillAddition(e.recipes[i],t.chefs[j].skill,t.ingredients);w>0&&(_=(1+D.qualityAddition+O+(c?e.furniture:0))*w)}C<_?(C=_,T=t.chefs[j].name+"["+D.qualityDisp+"]"):C===_&&(T+=","+t.chefs[j].name+"["+D.qualityDisp+"]");var M=new Object;M.qualityVal=D.qualityVal,M.qualityDisp=D.qualityDisp,M.efficiency=Math.floor(_)||"",u.chefs.push(M);var E=new Object;E.qualityVal=D.qualityVal,E.qualityDisp=D.qualityDisp,t.chefs[j].recipes.push(E)}var M=new Object;M.qualityDisp=C?T:"-",M.efficiency=Math.floor(C)||"",u.chefs.push(M),p.push(u)}return t.recipes=p,t}function generateCalRecipeData(e){var c=new Array;for(i in e)e[i].price&&c.push(e[i]);return c}function getIngredientsInfo(e){var i=new Object,c="",t="",a=0;for(var l in e.ingredients)e.ingredients[l].name&&(c+=e.ingredients[l].name+"*"+e.ingredients[l].quantity+" ",t+=e.ingredients[l].name,a+=e.ingredients[l].quantity);return i.ingredientsDisp=c,i.ingredientsVal=t,i.ingredientsCount=a,i}function getFireDisp(e){for(var i="",c=0;c<e;c++)i+="&#x2605;";return i}function getOriginVal(e){var i=0;return"菜棚"==e?i=1:"菜地"==e?i=2:"森林"==e?i=3:"鸡舍"==e?i=4:"猪圈"==e?i=5:"牧场"==e?i=6:"作坊"==e?i=7:"鱼塘"==e&&(i=8),i}function getKitchenwareOptions(e){var i=new Array,c=new Object;c.display="无厨具",c.subtext="",c.tokens="",c.value="",i.push(c);for(var t in e){var a=getSkillInfo(e[t].skill),l=a.skillDisp.replace("<br>"," "),c=new Object;c.display=e[t].name,c.subtext=l,c.tokens=e[t].name+l,c.value=e[t].name,i.push(c)}return i}function getChefsOptions(e){var i=new Array,c=new Object;c.display="无厨师",c.value="",i.push(c);for(var t in e){var c=new Object;c.display=e[t].name,c.value=e[t].name,i.push(c)}return i}function getRecipesOptions(e){var i=new Array,c=new Object;c.display="无菜谱",c.value="",i.push(c);for(var t in e){var c=new Object;c.display=e[t].name,c.value=e[t].name,i.push(c)}return i}function initRecipeShow(e,i,c){e.column(0).visible($("#chk-recipe-show-id").prop("checked"),!1),e.column(2).visible($("#chk-recipe-show-fire").prop("checked"),!1);var t=$("#chk-recipe-show-skill").prop("checked");e.column(3).visible(t,!1),e.column(4).visible(t,!1),e.column(5).visible(t,!1),e.column(6).visible(t,!1),e.column(7).visible(t,!1),e.column(8).visible(t,!1),e.column(9).visible($("#chk-recipe-show-ingredients").prop("checked"),!1),e.column(10).visible($("#chk-recipe-show-price").prop("checked"),!1),e.column(11).visible($("#chk-recipe-show-time").prop("checked"),!1),e.column(12).visible($("#chk-recipe-show-total").prop("checked"),!1),e.column(13).visible($("#chk-recipe-show-total-price").prop("checked"),!1),e.column(14).visible($("#chk-recipe-show-total-time").prop("checked"),!1),e.column(15).visible($("#chk-recipe-show-efficiency").prop("checked"),!1),e.column(16).visible($("#chk-recipe-show-ingredients-efficiency").prop("checked"),!1),e.column(17).visible($("#chk-recipe-show-origin").prop("checked"),!1),e.column(18).visible($("#chk-recipe-show-unlock").prop("checked"),!1),e.column(19).visible($("#chk-recipe-show-guest").prop("checked"),!1),e.column(20).visible($("#chk-recipe-show-level-guest").prop("checked"),!1),e.column(21).visible($("#chk-recipe-show-god-rune").prop("checked"),!1),c?e.column(22).visible($("#chk-recipe-show-quality").prop("checked"),!1):e.column(22).visible(!1,!1);for(var a=$("#chk-recipe-show-chef").val(),l=0;l<i.chefs.length;l++)e.column(23+2*l).visible(a.indexOf(l.toString())>-1,!1),e.column(24+2*l).visible(a.indexOf(l.toString())>-1,!1);e.columns.adjust().draw(!1)}function initChefShow(e,i){e.column(0).visible($("#chk-chef-show-id").prop("checked"),!1),e.column(2).visible($("#chk-chef-show-fire").prop("checked"),!1);var c=$("#chk-chef-show-skill").prop("checked");e.column(3).visible(c,!1),e.column(4).visible(c,!1),e.column(5).visible(c,!1),e.column(6).visible(c,!1),e.column(7).visible(c,!1),e.column(8).visible(c,!1),e.column(9).visible($("#chk-chef-show-special-skill").prop("checked"),!1);var t=$("#chk-chef-show-harvest").prop("checked");e.column(10).visible(t,!1),e.column(11).visible(t,!1),e.column(12).visible(t,!1),e.column(13).visible(t,!1),e.column(14).visible($("#chk-chef-show-sex").prop("checked"),!1),e.column(15).visible($("#chk-chef-show-origin").prop("checked"),!1);for(var a=$("#chk-chef-show-recipe").val(),l=0;l<i.recipes.length;l++)e.column(16+l).visible(a.indexOf(l.toString())>-1,!1);e.columns.adjust().draw(!1)}function initKitchenwareShow(e){e.column(0).visible($("#chk-kitchenware-show-id").prop("checked"),!1),e.column(2).visible($("#chk-kitchenware-show-fire").prop("checked"),!1),e.column(3).visible($("#chk-kitchenware-show-special-skill").prop("checked"),!1),e.column(4).visible($("#chk-kitchenware-show-origin").prop("checked"),!1),e.columns.adjust().draw(!1)}function initCalRecipesShow(e){e.column(1).visible($("#chk-cal-recipes-show-id").prop("checked"),!1),e.column(3).visible($("#chk-cal-recipes-show-fire").prop("checked"),!1);var i=$("#chk-cal-recipes-show-skill").prop("checked");e.column(4).visible(i,!1),e.column(5).visible(i,!1),e.column(6).visible(i,!1),e.column(7).visible(i,!1),e.column(8).visible(i,!1),e.column(9).visible(i,!1),e.column(10).visible($("#chk-cal-recipes-show-ingredient").prop("checked"),!1),e.column(11).visible($("#chk-cal-recipes-show-price").prop("checked"),!1),e.column(12).visible($("#chk-cal-recipes-show-total").prop("checked"),!1),e.column(13).visible($("#chk-cal-recipes-show-total-price").prop("checked"),!1),e.column(14).visible($("#chk-cal-recipes-show-origin").prop("checked"),!1),e.column(15).visible($("#chk-cal-recipes-addition").prop("checked"),!1),e.columns.adjust().draw(!1)}function initCalChefsShow(e){e.column(1).visible($("#chk-cal-chefs-show-id").prop("checked"),!1),e.column(3).visible($("#chk-cal-chefs-show-fire").prop("checked"),!1);var i=$("#chk-cal-chefs-show-skill").prop("checked");e.column(4).visible(i,!1),e.column(5).visible(i,!1),e.column(6).visible(i,!1),e.column(7).visible(i,!1),e.column(8).visible(i,!1),e.column(9).visible(i,!1),e.column(10).visible($("#chk-cal-chefs-show-special-skill").prop("checked"),!1),e.column(11).visible($("#chk-cal-chefs-show-sex").prop("checked"),!1),e.column(12).visible($("#chk-cal-chefs-show-origin").prop("checked"),!1),e.column(13).visible($("#chk-cal-chefs-addition").prop("checked"),!1),e.column(14).visible($("#chk-cal-chefs-kitchenware").prop("checked"),!1),e.columns.adjust().draw(!1)}function initCalIngredientsShow(e){e.column(1).visible($("#chk-cal-ingredients-show-id").prop("checked"),!1),e.column(3).visible($("#chk-cal-ingredients-show-fire").prop("checked"),!1),e.column(4).visible($("#chk-cal-ingredients-show-origin").prop("checked"),!1),e.column(5).visible($("#chk-cal-ingredients-addition").prop("checked"),!1),e.columns.adjust().draw(!1)}function initCalResultsShow(e,i,c){"recipes"==e&&(c.find(".chk-cal-results-show-chef-fire").prop("checked",!1).closest(".btn").addClass("hidden"),c.find(".chk-cal-results-show-chef-sex").prop("checked",!1).closest(".btn").addClass("hidden"),c.find(".chk-cal-results-show-chef-skill").prop("checked",!1).closest(".btn").addClass("hidden"),c.find(".chk-cal-results-show-recipe-quality").prop("checked",!1).closest(".btn").addClass("hidden"),c.find(".chk-cal-results-show-chef-kitchenware").prop("checked",!1).closest(".btn").addClass("hidden"),c.find(".chk-cal-results-show-chef-kitchenware-addition").prop("checked",!1).closest(".btn").addClass("hidden"),c.find(".chk-cal-results-show-recipe-real-total-price").prop("checked",!1).closest(".btn").addClass("hidden"),i.column(1).visible(!1,!1),i.column(22).visible(!1,!1),i.column(23).visible(!1,!1)),i.column(2).visible(c.find(".chk-cal-results-show-chef-fire").prop("checked"),!1),i.column(3).visible(c.find(".chk-cal-results-show-chef-sex").prop("checked"),!1);var t=c.find(".chk-cal-results-show-chef-skill").prop("checked");i.column(4).visible(t,!1),i.column(5).visible(t,!1),i.column(6).visible(t,!1),i.column(7).visible(t,!1),i.column(8).visible(t,!1),i.column(9).visible(t,!1),i.column(11).visible(c.find(".chk-cal-results-show-recipe-fire").prop("checked"),!1);var a=c.find(".chk-cal-results-show-recipe-skill").prop("checked");i.column(12).visible(a,!1),i.column(13).visible(a,!1),i.column(14).visible(a,!1),i.column(15).visible(a,!1),i.column(16).visible(a,!1),i.column(17).visible(a,!1),i.column(18).visible(c.find(".chk-cal-results-show-recipe-ingredient").prop("checked"),!1),i.column(21).visible(c.find(".chk-cal-results-show-recipe-quality").prop("checked"),!1),i.column(24).visible(c.find(".chk-cal-results-show-chef-kitchenware").prop("checked"),!1),i.column(25).visible(c.find(".chk-cal-results-show-chef-kitchenware-addition").prop("checked"),!1),i.column(26).visible(c.find(".chk-cal-results-show-bonus-addition").prop("checked"),!1),i.column(27).visible(c.find(".chk-cal-results-show-recipe-total-price").prop("checked"),!1),i.column(28).visible(c.find(".chk-cal-results-show-recipe-real-total-price").prop("checked"),!1),i.column(29).visible(c.find(".chk-cal-results-show-bonus-score").prop("checked"),!1),i.columns.adjust().draw(!1)}function initInfo(e){$("#pagination-history").pagination({dataSource:e.history,callback:function(e,i){var c=historyTemplate(e);$("#data-history").html(c)},pageSize:10,showPageNumbers:!1,showNavigator:!1,showPrevious:!1,showNext:!1})}function historyTemplate(e){var i="";return $.each(e,function(e,c){i+="<p>"+c+"</p>"}),i}function secondsToTime(e){e=Number(e);var i=Math.floor(e/3600/24),c=Math.floor(e/3600%24),t=Math.floor(e/60%60),a=Math.floor(e%60),l="";return i>0&&(l+=i+"天"),c>0&&(l+=c+"小时"),t>0&&(l+=t+"分"),a>0&&(l+=a+"秒"),l}function getInputHtml(e,i,c){var t,a,l;switch(l={type:"input",html:null},i.inputTypes&&$.each(i.inputTypes,function(i,c){c.column==e&&(t=c,a=t.type.toLowerCase())}),a){case"list":l.html="<select data-live-search='true' data-width='fit' data-dropdown-align-right='auto' data-live-search-placeholder='查找' data-none-results-text='没有找到'>",$.each(t.options,function(e,i){l.html=l.html+"<option value='"+i.value+"'",i.tokens&&(l.html+=" data-tokens='"+i.tokens+"'"),i.subtext&&(l.html+=" data-subtext='"+i.subtext+"'"),c==i.value&&(l.html+=" selected"),l.html+=">"+i.display+"</option>"}),l.html=l.html+"</select>",l.type=a;break;default:l.html="<input class='form-control' value='"+c+"'></input>"}return l}function sanitizeCellValue(e){return void 0===e||null===e||e.length<1?"":(isNaN(e)&&(e=e.replace(/'/g,"&#39;")),e)}$(function(){$.ajax({cache:!1,success:function(e){init(e)},url:"data/data.json"})}),$.fn.dataTable.Api.register("MakeCellsEditable()",function(e){var i=this.table();$.fn.extend({updateEditableCell:function(e,i){function c(){i.allowNulls.errorClass?$(r).addClass(i.allowNulls.errorClass):$(r).css({border:"red solid 1px"})}function t(e){s.data(e),i.onUpdate&&i.onUpdate(a,l,s)}var a=$(e).closest("table").DataTable().table(),l=a.row($(e).parents("tr")),s=a.cell($(e).closest("td")),n=s.index().column,r=$(e),o=r.val();!o&&i.allowNulls&&1!=i.allowNulls?i.allowNulls.columns?i.allowNulls.columns.indexOf(n)>-1?t(o):c():o||c():t(o)}}),"destroy"===e&&($(i.body()).off("click","td"),i=null),null!=i&&$(i.body()).on("click","td",function(){var c=i.cell(this).index().column;if(e.columns&&e.columns.indexOf(c)>-1||!e.columns){var t=i.cell(this).node(),a=i.cell(this).data();if(a=sanitizeCellValue(a),!$(t).find("input").length&&!$(t).find("select").length){var l=getInputHtml(c,e,a);$(t).html(l.html),"input"==l.type?$(t).find("input").select().focus().on("focusout",function(){$(this).updateEditableCell(this,e)}):"list"==l.type&&$(t).find("select").selectpicker("toggle").on("hidden.bs.select",function(i){$(this).updateEditableCell(this,e)})}}})});